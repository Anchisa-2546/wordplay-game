import streamlit as st
import time
import random

# ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå
word_categories = {
    "‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏® üåç": [
        {"word": "‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢", "hint": "üîë ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÉ‡∏ô‡πÄ‡∏≠‡πÄ‡∏ä‡∏µ‡∏¢‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÉ‡∏ï‡πâ"},
        {"word": "‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô", "hint": "üîë ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏†‡∏π‡πÄ‡∏Ç‡∏≤‡πÑ‡∏ü‡∏ü‡∏π‡∏à‡∏¥"},
        {"word": "‡∏ù‡∏£‡∏±‡πà‡∏á‡πÄ‡∏®‡∏™", "hint": "üîë ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏´‡∏≠‡πÑ‡∏≠‡πÄ‡∏ü‡∏•"},
        {"word": "‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤", "hint": "üîë ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÄ‡∏ó‡∏û‡∏µ‡πÄ‡∏™‡∏£‡∏µ‡∏†‡∏≤‡∏û"}
    ],
    "‡∏ú‡∏•‡πÑ‡∏°‡πâ üçé": [
        {"word": "‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á", "hint": "üîë ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á ‡∏¢‡∏≠‡∏î‡∏Æ‡∏¥‡∏ï‡πÉ‡∏ô‡πÑ‡∏ó‡∏¢"},
        {"word": "‡∏™‡∏ï‡∏£‡∏≠‡∏ß‡πå‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà", "hint": "üîë ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏™‡∏µ‡πÅ‡∏î‡∏á ‡∏°‡∏µ‡πÄ‡∏°‡∏•‡πá‡∏î‡∏£‡∏≠‡∏ö‡πÜ"},
        {"word": "‡πÅ‡∏ï‡∏á‡πÇ‡∏°", "hint": "üîë ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á ‡∏°‡∏µ‡πÄ‡∏°‡∏•‡πá‡∏î‡∏™‡∏µ‡∏î‡∏≥"},
        {"word": "‡∏Å‡∏•‡πâ‡∏ß‡∏¢", "hint": "üîë ‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á ‡∏¢‡∏≤‡∏ß‡πÅ‡∏•‡∏∞‡πÇ‡∏Ñ‡πâ‡∏á"}
    ],
    "‡∏™‡∏±‡∏ï‡∏ß‡πå üêæ": [
        {"word": "‡∏™‡∏¥‡∏á‡πÇ‡∏ï", "hint": "üîë ‡∏£‡∏≤‡∏ä‡∏≤‡πÅ‡∏´‡πà‡∏á‡∏õ‡πà‡∏≤"},
        {"word": "‡∏ä‡πâ‡∏≤‡∏á", "hint": "üîë ‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ö‡∏Å‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î"},
        {"word": "‡πÄ‡∏û‡∏ô‡∏Å‡∏ß‡∏¥‡∏ô", "hint": "üîë ‡∏ô‡∏Å‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡∏ö‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ"},
        {"word": "‡∏à‡∏£‡∏∞‡πÄ‡∏Ç‡πâ", "hint": "üîë ‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏∑‡πâ‡∏≠‡∏¢‡∏Ñ‡∏•‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏±‡πâ‡∏á‡∏ö‡∏ô‡∏ö‡∏Å‡πÅ‡∏•‡∏∞‡πÉ‡∏ô‡∏ô‡πâ‡∏≥"}
    ]
}

# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏Å‡∏°
def reset_game():
    selected_category = st.session_state.get("selected_category", "‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏® üåç")  
    word_data = random.choice(word_categories[selected_category])  
    st.session_state.word = word_data["word"]
    st.session_state.hint = word_data["hint"]
    st.session_state.time_left = 60  
    st.session_state.user_input = ""
    st.session_state.correct = None  
    st.session_state.running = True  

    # ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÉ‡∏´‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô 0
    if "score" not in st.session_state:
        st.session_state.score = 0  

    st.rerun()  # ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤ session_state
if "word" not in st.session_state:
    reset_game()

# UI ‡πÄ‡∏Å‡∏°
st.title("üéÆ WordPlay: ‡∏ó‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå")

# ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
st.write(f"üèÜ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: {st.session_state.get('score', 0)}/100")

# ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
category = st.selectbox("üìÇ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà", list(word_categories.keys()), key="selected_category")

# ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°
if st.button("üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°"):
    reset_game()

# ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ
st.write(f"üí° ‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ: {st.session_state.hint}")

# ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á
if st.session_state.running:
    if st.session_state.time_left > 0:
        st.session_state.time_left -= 1
        time.sleep(1)
        st.rerun()  
    else:
        st.session_state.running = False  

# ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ß‡∏•‡∏≤
st.write(f"‚è≥ ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠: {st.session_state.time_left} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ")

# ‡∏ä‡πà‡∏≠‡∏á‡∏õ‡πâ‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
user_input = st.text_input("üé≠ ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏¢", key="user_input")

# ‡∏õ‡∏∏‡πà‡∏°‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
if st.button("‚úÖ ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö") and st.session_state.running:
    if user_input.strip() == st.session_state.word:
        st.session_state.correct = True
        st.session_state.score += 10  # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏µ‡∏•‡∏∞ 10
        if st.session_state.score > 100:
            st.session_state.score = 100  # ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏µ‡πà 100
    else:
        st.session_state.correct = False
    st.session_state.running = False  
    st.rerun()

# ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
if st.session_state.correct is not None:
    if st.session_state.correct:
        st.success(f"üéâ ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! +10 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°: {st.session_state.score}/100)")
    else:
        st.error("‚ùå ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ú‡∏¥‡∏î ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà!")

# ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤
if not st.session_state.running and st.session_state.time_left == 0:
    st.warning("‚è≥ ‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤! ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà")

# ‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏Å‡∏°
if st.button("üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏Å‡∏°"):
    st.session_state.score = 0  # ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏õ‡πá‡∏ô 0
    reset_game()